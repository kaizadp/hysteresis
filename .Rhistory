mass =  readxl::read_excel("data/Core_weights.xlsx", sheet = "Mass_tracking")
View(mass)
mass =  readxl::read_excel("data/Core_weights.xlsx", sheet = "Mass_tracking")
mass =  readxl::read_excel("data/Core_weights.xlsx", sheet = "Mass_tracking") %>%
filter(!is.na(Site), Site != "AMB", Core != "0") %>%
left_join(ca, by = "Core")
ca <- readxl::read_excel("data/Core_key.xlsx") %>%
select(1:6)
mass =  readxl::read_excel("data/Core_weights.xlsx", sheet = "Mass_tracking") %>%
filter(!is.na(Site), Site != "AMB", Core != "0") %>%
left_join(ca, by = "Core") %>%
filter(is.na(skip))
ca <- readxl::read_excel("data/Core_key.xlsx") %>%
select(1:7)
View(ca)
mass =  readxl::read_excel("data/Core_weights.xlsx", sheet = "Mass_tracking") %>%
filter(!is.na(Site), Site != "AMB", Core != "0") %>%
left_join(ca, by = "Core")
mass =  readxl::read_excel("data/Core_weights.xlsx", sheet = "Mass_tracking") %>%
filter(!is.na(Site), Site != "AMB", Core != "0") %>%
left_join(ca, by = "Core") %>%
filter(is.na(skip))
read_massdata <- function(fqfn) {
ca <- readxl::read_excel("data/Core_key.xlsx") %>%
select(1:7)
readxl::read_excel(fqfn, sheet = "Mass_tracking") %>%
filter(!is.na(Site), Site != "AMB", Core != "0") %>%
left_join(ca, by = "Core") %>%
filter(is.na(skip))
}
plan <- drake_plan(
massdata_file = "data/Core_weights.xlsx",
massdata = read_massdata(massdata_file),
# README file and diagnostics
readme = rmarkdown::render(
knitr_in("README.Rmd"),
output_file = file_out("README.md"),
quiet = TRUE)
)
View(plan)
massdata_file = "data/Core_weights.xlsx"
massdata = read_massdata(massdata_file)
View(massdata)
View(mass)
names(mass)
View(mass)
ca <- readxl::read_excel("data/Core_key.xlsx") %>%
select(1:7)
dry <- read_excel(fqfn, sheet = "initial") %>%
select(Core, EmptyWt_g, DryWt_g)
dry <- read_excel("data/Core_key.xlsx", sheet = "initial") %>%
select(Core, EmptyWt_g, DryWt_g)
dry <- read_excel("data/Core_weights.xlsx", sheet = "initial") %>%
select(Core, EmptyWt_g, DryWt_g)
mass = readxl::read_excel(fqfn, sheet = "Mass_tracking") %>%
filter(!is.na(Site), Site != "AMB", Core != "0") %>%
left_join(ca, by = "Core") %>%
left_join(dry, by = "Core") %>%
filter(is.na(skip)) %>%
select(Core, Start_date, Start_time, Seq.Program, Core_assignment, EmptyWt_g, DryWt_g, Moisture)
mass = readxl::read_excel(Core_weights.xlsx, sheet = "Mass_tracking") %>%
filter(!is.na(Site), Site != "AMB", Core != "0") %>%
left_join(ca, by = "Core") %>%
left_join(dry, by = "Core") %>%
filter(is.na(skip)) %>%
select(Core, Start_date, Start_time, Seq.Program, Core_assignment, EmptyWt_g, DryWt_g, Moisture)
mass = readxl::read_excel("Core_weights.xlsx", sheet = "Mass_tracking") %>%
filter(!is.na(Site), Site != "AMB", Core != "0") %>%
left_join(ca, by = "Core") %>%
left_join(dry, by = "Core") %>%
filter(is.na(skip)) %>%
select(Core, Start_date, Start_time, Seq.Program, Core_assignment, EmptyWt_g, DryWt_g, Moisture)
mass = readxl::read_excel("data/Core_weights.xlsx", sheet = "Mass_tracking") %>%
filter(!is.na(Site), Site != "AMB", Core != "0") %>%
left_join(ca, by = "Core") %>%
left_join(dry, by = "Core") %>%
filter(is.na(skip)) %>%
select(Core, Start_date, Start_time, Seq.Program, Core_assignment, EmptyWt_g, DryWt_g, Moisture)
mass = readxl::read_excel("data/Core_weights.xlsx", sheet = "Mass_tracking") %>%
filter(!is.na(Site), Site != "AMB", Core != "0") %>%
left_join(ca, by = "Core") %>%
left_join(dry, by = "Core") %>%
filter(is.na(skip))
View(mass)
ca <- readxl::read_excel("data/Core_key.xlsx") %>%
select(1:7)
dry <- read_excel("data/Core_weights.xlsx", sheet = "initial") %>%
select(Core, EmptyWt_g, DryWt_g)
mass = readxl::read_excel("data/Core_weights.xlsx", sheet = "Mass_tracking") %>%
filter(!is.na(Site), Site != "AMB", Core != "0") %>%
left_join(ca, by = "Core") %>%
left_join(dry, by = "Core") %>%
filter(is.na(skip)) %>%
select(Core, Start_date, Start_time, Seq.Program, Core_assignment, EmptyWt_g, DryWt_g, Moisture)
View(mass)
mass = readxl::read_excel("data/Core_weights.xlsx", sheet = "Mass_tracking") %>%
filter(!is.na(Site), Site != "AMB", Core != "0") %>%
left_join(ca, by = "Core") %>%
left_join(dry, by = "Core") %>%
filter(is.na(skip))
mass = readxl::read_excel("data/Core_weights.xlsx", sheet = "Mass_tracking") %>%
filter(!is.na(Site), Site != "AMB", Core != "0") %>%
left_join(ca, by = "Core") %>%
left_join(dry, by = "Core") %>%
filter(is.na(skip)) %>%
select(Core, Start_date, Start_time, Seq.Program, Core_assignment, EmptyWt_g, DryWt_g, Mass, Moisture)
mass = readxl::read_excel("data/Core_weights.xlsx", sheet = "Mass_tracking") %>%
filter(!is.na(Site), Site != "AMB", Core != "0") %>%
left_join(ca, by = "Core") %>%
left_join(dry, by = "Core") %>%
filter(is.na(skip)) %>%
select(Core, Start_date, Start_time, Seq.Program, Core_assignment, EmptyWt_g, DryWt_g, Mass_g, Moisture)
mass = readxl::read_excel("data/Core_weights.xlsx", sheet = "Mass_tracking") %>%
filter(!is.na(Site), Site != "AMB", Core != "0") %>%
left_join(ca, by = "Core") %>%
left_join(dry, by = "Core") %>%
filter(is.na(skip)) %>%
select(Core, Start_date, Start_time, Seq.Program, Core_assignment, EmptyWt_g, DryWt_g, Mass_g, Moisture) %>%
mutate(Start_time = as.POSIXct(strptime(Start_time,format = "%H:%M")),
DryWt_g = round(DryWt_g,2))
ca <- readxl::read_excel("data/Core_key.xlsx") %>%
select(1:7)
dry <- read_excel("data/Core_weights.xlsx", sheet = "initial") %>%
select(Core, EmptyWt_g, DryWt_g)
mass = readxl::read_excel("data/Core_weights.xlsx", sheet = "Mass_tracking") %>%
filter(!is.na(Site), Site != "AMB", Core != "0") %>%
left_join(ca, by = "Core") %>%
left_join(dry, by = "Core") %>%
filter(is.na(skip)) %>%
select(Core, Start_datetime, Seq.Program, Core_assignment, EmptyWt_g, DryWt_g, Mass_g, Moisture) %>%
mutate(Start_datetime = as.POSIXct(strptime(Start_datetime,format = "%m/%d/%Y %H:%M")),
DryWt_g = round(DryWt_g,2))
read_massdata <- function(fqfn) {
ca <- readxl::read_excel("data/Core_key.xlsx") %>%
select(1:7)
dry <- read_excel(fqfn, sheet = "initial") %>%
select(Core, EmptyWt_g, DryWt_g)
mass = readxl::read_excel(fqfn, sheet = "Mass_tracking") %>%
filter(!is.na(Site), Site != "AMB", Core != "0") %>%
left_join(ca, by = "Core") %>%
left_join(dry, by = "Core") %>%
filter(is.na(skip)) %>%
select(Core, Start_datetime, Seq.Program, Core_assignment, EmptyWt_g, DryWt_g, Mass_g, Moisture) %>%
mutate(Start_datetime = as.POSIXct(strptime(Start_datetime,format = "%m/%d/%Y %H:%M")),
DryWt_g = round(DryWt_g,2))
}
plan <- drake_plan(
massdata_file = "data/Core_weights.xlsx",
massdata = read_massdata(massdata_file),
# README file and diagnostics
readme = rmarkdown::render(
knitr_in("README.Rmd"),
output_file = file_out("README.md"),
quiet = TRUE)
)
massdata = read_massdata(massdata_file)
View(massdata)
read_massdata <- function(fqfn) {
ca <- readxl::read_excel("data/Core_key.xlsx") %>%
select(1:7)
dry <- read_excel(fqfn, sheet = "initial") %>%
select(Core, EmptyWt_g, DryWt_g)
mass = readxl::read_excel(fqfn, sheet = "Mass_tracking") %>%
filter(!is.na(Site), Site != "AMB", Core != "0") %>%
left_join(ca, by = "Core") %>%
left_join(dry, by = "Core") %>%
filter(is.na(skip)) %>%
select(Core, Start_datetime, Seq.Program, Core_assignment, EmptyWt_g, DryWt_g, Mass_g, Moisture) %>%
mutate(Start_datetime = as.POSIXct(strptime(Start_datetime,format = "%m/%d/%Y %H:%M")),
DryWt_g = round(DryWt_g,2),
Moisture_perc = ((Mass_g - EmptyWt_g - DryWt_g)/DryWt_g)*100)
}
massdata = read_massdata(massdata_file)
read_massdata <- function(fqfn) {
ca <- readxl::read_excel("data/Core_key.xlsx") %>%
select(1:7)
dry <- read_excel(fqfn, sheet = "initial") %>%
select(Core, EmptyWt_g, DryWt_g)
mass = readxl::read_excel(fqfn, sheet = "Mass_tracking") %>%
filter(!is.na(Site), Site != "AMB", Core != "0") %>%
left_join(ca, by = "Core") %>%
left_join(dry, by = "Core") %>%
filter(is.na(skip)) %>%
select(Core, Start_datetime, Seq.Program, Core_assignment, EmptyWt_g, DryWt_g, Mass_g, Moisture) %>%
mutate(Start_datetime = as.POSIXct(strptime(Start_datetime,format = "%m/%d/%Y %H:%M")),
DryWt_g = round(DryWt_g,2),
Moisture_perc = round(((Mass_g - EmptyWt_g - DryWt_g)/DryWt_g)*100,2))
}
plan <- drake_plan(
massdata_file = "data/Core_weights.xlsx",
massdata = read_massdata(massdata_file),
# README file and diagnostics
readme = rmarkdown::render(
knitr_in("README.Rmd"),
output_file = file_out("README.md"),
quiet = TRUE)
)
read_massdata <- function(fqfn) {
ca <- readxl::read_excel("data/Core_key.xlsx") %>%
select(1:7)
dry <- read_excel(fqfn, sheet = "initial") %>%
select(Core, EmptyWt_g, DryWt_g)
mass = readxl::read_excel(fqfn, sheet = "Mass_tracking") %>%
filter(!is.na(Site), Site != "AMB", Core != "0") %>%
left_join(ca, by = "Core") %>%
left_join(dry, by = "Core") %>%
filter(is.na(skip)) %>%
select(Core, Start_datetime, Seq.Program, Core_assignment, EmptyWt_g, DryWt_g, Mass_g, Moisture) %>%
mutate(Start_datetime = as.POSIXct(strptime(Start_datetime,format = "%m/%d/%Y %H:%M")),
DryWt_g = round(DryWt_g,2),
Moisture_perc = round((((Mass_g - EmptyWt_g - DryWt_g)/DryWt_g)*100),2))
}
massdata = read_massdata(massdata_file)
read_massdata <- function(fqfn) {
ca <- readxl::read_excel("data/Core_key.xlsx") %>%
select(1:7)
dry <- read_excel(fqfn, sheet = "initial") %>%
select(Core, EmptyWt_g, DryWt_g)
mass = readxl::read_excel(fqfn, sheet = "Mass_tracking") %>%
filter(!is.na(Site), Site != "AMB", Core != "0") %>%
left_join(ca, by = "Core") %>%
left_join(dry, by = "Core") %>%
filter(is.na(skip)) %>%
select(Core, Start_datetime, Seq.Program, Core_assignment, EmptyWt_g, DryWt_g, Mass_g, Moisture) %>%
mutate(Start_datetime = as.POSIXct(strptime(Start_datetime,format = "%m/%d/%Y %H:%M")),
DryWt_g = round(DryWt_g,2),
MoistWt_g = Mass_g - EmptyWt_g,
Moisture_perc = round((((MoistWt_g - DryWt_g)/DryWt_g)*100),2))
}
massdata = read_massdata(massdata_file)
read_massdata <- function(fqfn) {
ca <- readxl::read_excel("data/Core_key.xlsx") %>%
select(1:7)
dry <- read_excel(fqfn, sheet = "initial") %>%
select(Core, EmptyWt_g, DryWt_g)
mass = readxl::read_excel(fqfn, sheet = "Mass_tracking") %>%
filter(!is.na(Site), Site != "AMB", Core != "0") %>%
left_join(ca, by = "Core") %>%
left_join(dry, by = "Core") %>%
filter(is.na(skip)) %>%
select(Core, Start_datetime, Seq.Program, Core_assignment, EmptyWt_g, DryWt_g, Mass_g, Moisture) %>%
mutate(Start_datetime = as.POSIXct(strptime(Start_datetime,format = "%m/%d/%Y %H:%M")),
DryWt_g = round(DryWt_g,2),
MoistWt_g = Mass_g - EmptyWt_g,
Water_g = MoistWt_g - DryWt_g,
Moisture_perc = round((((MoistWt_g - DryWt_g)/DryWt_g)*100),2))
}
massdata = read_massdata(massdata_file)
read_massdata <- function(fqfn) {
ca <- readxl::read_excel("data/Core_key.xlsx") %>%
select(1:7)
dry <- read_excel(fqfn, sheet = "initial") %>%
select(Core, EmptyWt_g, DryWt_g)
mass = readxl::read_excel(fqfn, sheet = "Mass_tracking") %>%
filter(!is.na(Site), Site != "AMB", Core != "0") %>%
left_join(ca, by = "Core") %>%
left_join(dry, by = "Core") %>%
filter(is.na(skip)) %>%
select(Core, Start_datetime, Seq.Program, Core_assignment, EmptyWt_g, DryWt_g, Mass_g, Moisture) %>%
mutate(Start_datetime = as.POSIXct(strptime(Start_datetime,format = "%m/%d/%Y %H:%M")),
DryWt_g = round(DryWt_g,2),
MoistWt_g = Mass_g - EmptyWt_g,
Water_g = MoistWt_g - DryWt_g,
Moisture_perc = round(((Water_g/DryWt_g)*100),2))
}
massdata = read_massdata(massdata_file)
ggplot(massdata, aes(Days, Moisture_perc, group = `Core`)) +
geom_point() + geom_line()
readd("massdata") %>%
mutate(Days = as.integer(difftime(Start_datetime, min(Start_datetime), units = "hours"))) ->
massdata
massdata %>%
mutate(Days = as.integer(difftime(Start_datetime, min(Start_datetime), units = "hours"))) ->
massdata
ggplot(massdata, aes(Days, Moisture_perc, group = `Core`)) +
geom_point() + geom_line()
massdata %>%
group_by(Core) %>%
mutate(Hours = as.integer(difftime(Start_datetime, min(Start_datetime), units = "hours"))) ->
massdata
ggplot(massdata, aes(Hours, Moisture_perc, group = `Core`)) +
geom_point() + geom_line()
# HYSTERESIS AND SOIL C
# Kaizad F. Patel
# Oct. 25, 2019
# tracking moisture content in soil cores
### taken from BBL's script TESDrydown/drake_plan.R
# drake plan
library(drake)
pkgconfig::set_config("drake::strings_in_dots" = "literals")
library(ggplot2)
theme_set(theme_bw())
library(googlesheets)
library(readxl)
library(tidyr)
library(dplyr)
# download_massdata <- function(fqfn) {
#   readxl::read_xlsx("Core_key.xlsx") %>%
#     filter(is.na(skip)) %>%
#     select(1:6)
# }
read_massdata <- function(fqfn) {
ca <- readxl::read_excel("data/Core_key.xlsx") %>%
select(1:7)
dry <- read_excel(fqfn, sheet = "initial") %>%
select(Core, EmptyWt_g, DryWt_g)
mass = readxl::read_excel(fqfn, sheet = "Mass_tracking") %>%
filter(!is.na(Site), Site != "AMB", Core != "0") %>%
left_join(ca, by = "Core") %>%
left_join(dry, by = "Core") %>%
filter(is.na(skip)) %>%
select(Core, Start_datetime, Seq.Program, Core_assignment, EmptyWt_g, DryWt_g, Mass_g, Moisture) %>%
mutate(Start_datetime = as.POSIXct(strptime(Start_datetime,format = "%m/%d/%Y %H:%M")),
DryWt_g = round(DryWt_g,2),
MoistWt_g = Mass_g - EmptyWt_g,
Water_g = MoistWt_g - DryWt_g,
Moisture_perc = round(((Water_g/DryWt_g)*100),2))
}
plan <- drake_plan(
massdata_file = "data/Core_weights.xlsx",
massdata = read_massdata(massdata_file),
# README file and diagnostics
readme = rmarkdown::render(
knitr_in("README.Rmd"),
output_file = file_out("README.md"),
quiet = TRUE)
)
ca <- readxl::read_excel("data/Core_key.xlsx") %>%
select(1:7)
dry <- read_excel(fqfn, sheet = "initial") %>%
select(Core, EmptyWt_g, DryWt_g)
mass = readxl::read_excel(fqfn, sheet = "Mass_tracking") %>%
filter(!is.na(Site), Site != "AMB", Core != "0") %>%
left_join(ca, by = "Core") %>%
left_join(dry, by = "Core") %>%
filter(is.na(skip)) %>%
select(Core, Start_datetime, Seq.Program, Core_assignment, EmptyWt_g, DryWt_g, Mass_g, Moisture) %>%
mutate(Start_datetime = as.POSIXct(strptime(Start_datetime,format = "%m/%d/%Y %H:%M")),
DryWt_g = round(DryWt_g,2),
MoistWt_g = Mass_g - EmptyWt_g,
Water_g = MoistWt_g - DryWt_g,
Moisture_perc = round(((Water_g/DryWt_g)*100),2))
make(plan)
make(plan)
make(plan)
diagnose(readme)
make(plan)
make(plan)
plan <- drake_plan(
massdata_file = "data/Core_weights.xlsx",
massdata = read_massdata(massdata_file))
ggplot(massdata, aes(Hours, Moisture_perc, group = `Core`)) +
geom_point() + geom_line()
massdata_file = "data/Core_weights.xlsx",
massdata = read_massdata(massdata_file)
massdata_file = "data/Core_weights.xlsx"
massdata = read_massdata(massdata_file)
View(massdata)
massdata %>%
group_by(Core) %>%
dplyr::mutate(Hours = as.integer(difftime(Start_datetime, min(Start_datetime), units = "hours"))) ->
massdata
ggplot(massdata, aes(Hours, Moisture_perc, group = `Core`)) +
geom_point() + geom_line()
View(massdata)
ggplot(massdata, aes(Hours, Moisture_perc, group = `Core`)) +
geom_point() + geom_line()+
facet_wrap(~Core_assignment)
read_massdata <- function(fqfn) {
ca <- readxl::read_excel("data/Core_key.xlsx") %>%
select(1:7)
dry <- read_excel(fqfn, sheet = "initial") %>%
select(Core, EmptyWt_g, DryWt_g)
mass = readxl::read_excel(fqfn, sheet = "Mass_tracking") %>%
filter(!is.na(Site), Site != "AMB", Core != "0") %>%
left_join(ca, by = "Core") %>%
left_join(dry, by = "Core") %>%
filter(is.na(skip)) %>%
select(Core, Start_datetime, Seq.Program, Core_assignment, EmptyWt_g, DryWt_g, Mass_g, Moisture) %>%
mutate(Start_datetime = as.POSIXct(strptime(Start_datetime,format = "%m/%d/%Y %H:%M")),
DryWt_g = round(DryWt_g,2),
MoistWt_g = Mass_g - EmptyWt_g,
Water_g = MoistWt_g - DryWt_g,
Moisture_perc = round(((Water_g/DryWt_g)*100),2))
}
massdata_file = "data/Core_weights.xlsx"
massdata = read_massdata(massdata_file)
ggplot(massdata, aes(Hours, Moisture_perc, group = `Core`)) +
geom_point() + geom_line()+
facet_wrap(~Core_assignment)
readd("massdata") %>%
massdata %>%
group_by(Core) %>%
dplyr::mutate(Hours = as.integer(difftime(Start_datetime, min(Start_datetime), units = "hours"))) ->
massdata
readd("massdata") %>%
massdata %>%
group_by(Core) %>%
dplyr::mutate(Hours = as.integer(difftime(Start_datetime, min(Start_datetime), units = "hours"))) ->
massdata
massdata %>%
group_by(Core) %>%
dplyr::mutate(Hours = as.integer(difftime(Start_datetime, min(Start_datetime), units = "hours"))) ->
massdata
ggplot(massdata, aes(Hours, Moisture_perc, group = `Core`)) +
geom_point() + geom_line()+
facet_wrap(~Core_assignment)
read_massdata <- function(fqfn) {
ca <- readxl::read_excel("data/Core_key.xlsx") %>%
select(1:7)
dry <- read_excel(fqfn, sheet = "initial") %>%
select(Core, EmptyWt_g, DryWt_g)
mass = readxl::read_excel(fqfn, sheet = "Mass_tracking") %>%
filter(!is.na(Site), Site != "AMB", Core != "0") %>%
left_join(ca, by = "Core") %>%
left_join(dry, by = "Core") %>%
filter(is.na(skip)) %>%
select(Core, Start_datetime, Seq.Program, Core_assignment, EmptyWt_g, DryWt_g, Mass_g, Moisture) %>%
mutate(Start_datetime = as.POSIXct(strptime(Start_datetime,format = "%m/%d/%Y %H:%M")),
DryWt_g = round(DryWt_g,2),
MoistWt_g = Mass_g - EmptyWt_g,
Water_g = MoistWt_g - DryWt_g,
Moisture_perc = round(((Water_g/DryWt_g)*100),2))
}
massdata_file = "data/Core_weights.xlsx"
massdata = read_massdata(massdata_file)
massdata %>%
group_by(Core) %>%
dplyr::mutate(Hours = as.integer(difftime(Start_datetime, min(Start_datetime), units = "hours"))) ->
massdata
ggplot(massdata, aes(Hours, Moisture_perc, group = `Core`)) +
geom_point() + geom_line()+
facet_wrap(~Core_assignment)
ggplot(massdata, aes(Hours, Moisture_perc, group = `Core`)) +
geom_point() + geom_line()+
facet_wrap(~Core_assignment)+
ylim(0,175)
read_massdata <- function(fqfn) {
ca <- readxl::read_excel("data/Core_key.xlsx") %>%
select(1:7)
dry <- read_excel(fqfn, sheet = "initial") %>%
select(Core, EmptyWt_g, DryWt_g)
mass = readxl::read_excel(fqfn, sheet = "Mass_tracking") %>%
filter(!is.na(Site), Site != "AMB", Core != "0") %>%
left_join(ca, by = "Core") %>%
left_join(dry, by = "Core") %>%
filter(is.na(skip)) %>%
select(Core, Start_datetime, Seq.Program, Core_assignment, EmptyWt_g, DryWt_g, Mass_g, Moisture) %>%
mutate(Start_datetime = as.POSIXct(strptime(Start_datetime,format = "%m/%d/%Y %H:%M")),
DryWt_g = round(DryWt_g,2),
MoistWt_g = Mass_g - EmptyWt_g,
Water_g = MoistWt_g - DryWt_g,
Moisture_perc = round(((Water_g/DryWt_g)*100),2))
}
plan <- drake_plan(
massdata_file = "data/Core_weights.xlsx",
massdata = read_massdata(massdata_file),
# README file and diagnostics
moisture = rmarkdown::render(
knitr_in("1b-moisture_markdown.Rmd"),
output_file = file_out("1b-moisture_markdown.md"),
quiet = TRUE)
)
make(plan)
read_massdata <- function(fqfn) {
ca <- readxl::read_excel("data/Core_key.xlsx") %>%
select(1:7)
dry <- read_excel(fqfn, sheet = "initial") %>%
select(Core, EmptyWt_g, DryWt_g)
mass = readxl::read_excel(fqfn, sheet = "Mass_tracking") %>%
filter(!is.na(Site), Site != "AMB", Core != "0") %>%
left_join(ca, by = "Core") %>%
left_join(dry, by = "Core") %>%
filter(is.na(skip)) %>%
select(Core, Start_datetime, Seq.Program, Core_assignment, EmptyWt_g, DryWt_g, Mass_g, Moisture) %>%
mutate(Start_datetime = as.POSIXct(strptime(Start_datetime,format = "%m/%d/%Y %H:%M")),
DryWt_g = round(DryWt_g,2),
MoistWt_g = Mass_g - EmptyWt_g,
Water_g = MoistWt_g - DryWt_g,
Moisture_perc = round(((Water_g/DryWt_g)*100),2))
}
plan <- drake_plan(
massdata_file = "data/Core_weights.xlsx",
massdata = read_massdata(massdata_file),
# README file and diagnostics
moisture = rmarkdown::render(
knitr_in("1b-moisture_markdown.Rmd"),
output_file = file_out("1b-moisture_markdown.md"),
quiet = TRUE)
)
make(plan)
diagnose(moisture)
make(plan)
View(plan)
source("1-moisture_tracking.R")
readd("massdata") %>%
group_by(Core) %>%
dplyr::mutate(Hours = as.integer(difftime(Start_datetime, min(Start_datetime), units = "hours"))) ->
massdata
ggplot(massdata, aes(Hours, Moisture_perc, group = `Core`)) +
geom_point() + geom_line()+
facet_wrap(~Core_assignment)+
ylim(0,175)
source("1-moisture_tracking.R")
readd("massdata") %>%
group_by(Core) %>%
dplyr::mutate(Hours = as.integer(difftime(Start_datetime, min(Start_datetime), units = "hours"))) ->
massdata
ggplot(massdata, aes(Hours, Moisture_perc, group = `Core`, color = as.factor(Core))) +
geom_point() + geom_line()+
facet_wrap(~Core_assignment)+
ylim(0,175)
